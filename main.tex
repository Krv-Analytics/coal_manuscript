% !TEX program = pdflatex
% pdflatex -shell-escape main.tex

\documentclass{article}
\usepackage{svg}
\usepackage{subfiles}
\usepackage{hyperref}
\usepackage{hyperxmp}
\usepackage{qrcode}
\usepackage{float}

\usepackage{geometry}
\usepackage{tabularx, ltablex}
\usepackage{booktabs}
\usepackage{graphicx}
\usepackage{adjustbox}
\usepackage{float}

\usepackage[document]{ragged2e}
\usepackage{subcaption}

\usepackage{graphicx}
% \usetikzlibrary{shapes, positioning}
\usepackage{tikz}
\usepackage{xcolor}




%% Revising Macros for Sid, Grace, Stu, and Jez
\newcommand{\sidTodo}[1]{{\color{red}[Sid: {#1}]}}
\newcommand{\sidNote}[1]{\marginpar{\textcolor{red}{$\leftarrow$\fbox{Sid}}}\footnote{\sf {\color{red}Sid: {#1}}}}

\newcommand{\stuTodo}[1]{{\color{magenta}[Stu: {#1}]}}
\newcommand{\stuNote}[1]{\marginpar{\textcolor{magenta}{$\leftarrow$\fbox{Stu}}}\footnote{\sf {\color{magenta}Stu: {#1}}}}

\newcommand{\jezTodo}[1]{{\color{green}[Jez: {#1}]}}
\newcommand{\jezNote}[1]{\marginpar{\textcolor{green}{$\leftarrow$\fbox{Jez}}}\footnote{\sf {\color{green}Jez: {#1}}}}

\newcommand{\graceTodo}[1]{{\color{blue}[Grace: {#1}]}}
\newcommand{\graceNote}[1]{\marginpar{\textcolor{blue}{$\leftarrow$\fbox{Grace}}}\footnote{\sf {\color{blue}Grace: {#1}}}}


%  ╭────────────────────────────────────────────────────────────────────────────────────────╮
%  │  Imports required for table formatting -- see table_testing.tex for more info          |
%  ╰────────────────────────────────────────────────────────────────────────────────────────╯

% \usepackage{booktabs}
% \usepackage{caption}
% \usepackage{float}
% \usepackage{titlesec}
% \usepackage{capt-of}

% %dashed line
% \usepackage{array}
% \usepackage{arydshln}
% \setlength\dashlinedash{0.2pt}
% \setlength\dashlinegap{1.5pt}
% \setlength\arrayrulewidth{0.3pt}


\usepackage{geometry}
 \geometry{
 letterpaper,
 total={170mm,257mm},
 left=20mm,
 top=20mm,
 bottom=20mm,
 }

\definecolor{lightgrey}{RGB}{230,230,230}
\definecolor{bleu}{RGB}{ 49,140,231}

\newcommand{\highlight}[1]{%
  \fcolorbox{black}{lightgrey}{%
    \parbox{\dimexpr\linewidth-2\fboxsep-2\fboxrule}{%
    #1%
    }%
  }%
}

\hypersetup{
  colorlinks = true,
  urlcolor   = bleu,
  linkcolor  = bleu,
  citecolor  = bleu,
}

\title{Coal Manuscript - \textit{WIP draft}}
\author{}

% To add affiliations with authors, see: https://tex.stackexchange.com/a/604401/303504

\let\truehypersetup\hypersetup
\renewcommand\hypersetup[1]{}
\usepackage{bigfoot}
\let\hypersetup\truehypersetup

\DeclareNewFootnote{AAffil}[arabic]
\DeclareNewFootnote{ANote}[fnsymbol]

\usepackage{etoolbox}
\makeatletter
\patchcmd\maketitle{\def\@makefnmark{\rlap{\@textsuperscript{\normalfont\@thefnmark}}}}{}{}{}
\makeatother

% Hook into the \thanks command for the article class to print the footnotes
\makeatletter
\def\thanksAAffil#1{%
  \footnotemarkAAffil\protected@xdef\@thanks{\@thanks%
        \protect\footnotetextAAffil[\the \c@footnoteAAffil]{#1}}%
}
\def\thanksANote#1{%
  \footnotemarkANote%
  \protected@xdef\@thanks{\@thanks%
        \protect\footnotetextANote[\the \c@footnoteANote]{#1}}%
}
\makeatother

\date{}

\begin{document}

\maketitle


%  ╭──────────────────────────────────────────────────────────╮
%  │ Outline                                                  |
%  ╰──────────────────────────────────────────────────────────╯

% \input{outline}
% \input{table_testing.tex}


%  ╭──────────────────────────────────────────────────────────╮
%  │ Intro                                                    |
%  ╰──────────────────────────────────────────────────────────╯
\stuTodo{I've put in some macros for notes and todos. If my name is Sid, example usage is $\backslash$sidTodo for todos and $\backslash$sidNote for notes. (Supported for Sid, Grace, Stu and Jez.) }
\input{intro}

\input{motivating_methodology}


%  ╭──────────────────────────────────────────────────────────╮
%  │ Results                                                  |
%  ╰──────────────────────────────────────────────────────────╯

\input{results}


%  ╭──────────────────────────────────────────────────────────╮
%  │ Discussion                                               |
%  ╰──────────────────────────────────────────────────────────╯


%  ╭──────────────────────────────────────────────────────────╮
%  │ Methods                                                  |
%  ╰──────────────────────────────────────────────────────────╯


%  ╭──────────────────────────────────────────────────────────╮
%  │ Post-paper                                               |
%  ╰──────────────────────────────────────────────────────────╯

\section{Supplemental Info/Figs}

\input{dataset_tables}
\input{FIG-MLscoring.tex}
\input{FIGS-SIs.tex}

\end{document}








%  ╭──────────────────────────────────────────────────────────╮
%  │ EXTRAs - will be moved/deleted                           |
%  ╰──────────────────────────────────────────────────────────╯


% \begin{figure}[H]
%     \includesvg[inkscapelatex=false,width=1\columnwidth]{svg_figs/group_map.svg}
%     \label{fig:2}
%     \caption{\textbf{Plant Group Locations} Illustrates the locations of the plants in every group.}
% \end{figure}



% \begin{figure}[H]
%     \includesvg[inkscapelatex=false,width=1\columnwidth]{svg_figs/ml_featureImportance_accuracy.svg}
%     \includesvg[inkscapelatex=false,width=1\columnwidth]{svg_figs/ml_prediction_accuracy.svg}
%     \label{fig:2}
%     \caption{\textbf{Predicting Planned Retirements in the US Coal Plant Fleet} In the top figure, there is a clear difference between each method, with no clear consensus on a subset of variables that are important for predicting planned retirement. In the bottom figure, F1-Scores averaging 0.5 indicate that across 100 different runs, these models do not preform well in terms of their ability to balance precision and recall. 0.8 is considered the standard threshold at which F1-Scores indicate a model has preformed well. In other words, these methods poorly predict planned retirement and the key variables responsible for it.}
% \end{figure}



% \begin{figure}[H]

%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_1_vulnerability.png}
%         \subcaption{Group 1 Subgraph}
%     \end{minipage}%
%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_2_vulnerability.png}
%         \subcaption{Group 2 Subgraph}
%     \end{minipage}
    
%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_3_vulnerability.png}
%         \subcaption{Group 3 Subgraph}
%     \end{minipage}%
%     \begin{minipage}{0.4\textwidth}
%         \raggedleft
%         \includesvg[inkscapelatex=false,width=1\linewidth]{svg_figs/vulnerability_barPolar.svg}
%         \subcaption{Vulnerability Proxies per Group (by coal plant)}
%     \end{minipage}

%     \caption{\textbf{Proximity To Retirement Graphs} Nodes representing coal plants with the highest percentage of retiring capacity per plant are identified as target nodes. The edges in the graph are weighted to indicate the relationships between nodes. Employing Dijkstra's algorithm, we determine the shortest path and corresponding distance from these target nodes to every other node in the graph. This distance signifies the level of similarity; nodes with shorter paths to target nodes share more similar attributes with the retiring nodes. Conversely, nodes with longer distances have more dissimilar characteristics, indicating a greater divergence from the attributes of the retiring plants within nodes. \textit{Explain edge weighting here as well?}}
%     \label{fig:3}
% \end{figure}

% \begin{figure}[H]

%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_1_vulnerability.png}  
%     \end{minipage}%
%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_2_vulnerability.png}  
%     \end{minipage}
%     \begin{minipage}{0.5\textwidth}
%         \includegraphics[width=\linewidth]{png_figs/shortest_path/group_3_vulnerability.png}  
%     \end{minipage}%
%     \begin{minipage}{0.4\textwidth}
%         \raggedleft
%         \includesvg[inkscapelatex=false,width=1\linewidth]{svg_figs/vulnerability_barPolar.svg}
%     \end{minipage}
        
%     \caption{\textbf{Proximity To Retirement Graphs} Nodes representing coal plants with the highest percentage of retiring capacity per plant are identified as target nodes. The edges in the graph are weighted to indicate the relationships between nodes. Employing Dijkstra's algorithm, we determine the shortest path and corresponding distance from these target nodes to every other node in the graph.
%     % This is our approximation for a "coarse-grained" geodesic distance in high dimensional space
%     This distance signifies the level of similarity; nodes with shorter paths to target nodes share more similar attributes with the retiring nodes. Conversely, nodes with longer distances have more dissimilar characteristics, indicating a greater divergence between the plants contained within them and the attributes of the retiring plants within target nodes. \textit{explain edge weighting here as well?}}
%     \label{fig:3}
% \end{figure}

% \begin{figure}[H]
%     \centering
%     \includegraphics[width=1\textwidth]{png_figs/shortest_path/group_1_vulnerability.png}  
%     \includegraphics[width=1\textwidth]{png_figs/shortest_path/group_2_vulnerability.png}  
%     \includegraphics[width=1\textwidth]{png_figs/shortest_path/group_3_vulnerability.png}  
%     %     \begin{tikzpicture}[overlay, remember picture, on background layer]
%     %     % Legend elements
%     %     \foreach \i in {0,1,2,3,4} {
%     %         \node [rectangle, fill=col\i, minimum size=0.3cm] at ({(\i+0.7)*2.5-7.5+0.3}, 0.5) {};
%     %         \node [right] at ({(\i+0.7)*2.5-7.2+0.3}, 0.5) {Group \i};}
%     %     \foreach \i in {5, 6, 7, 8} {
%     %         \node [rectangle, fill=col\i, minimum size=0.3cm] at ({(\i-3.8)*2.5-7.5+0.3}, -0.1) {};
%     %         \node [right] at ({(\i-3.8)*2.5-7.2+0.3}, -0.1) {Group \i};}
%     % \end{tikzpicture}
%     \caption{\textbf{Coal Fleet Graph} Each group has a unique mix of plant attributes across all categories. \textit{will need to find an additional model that highlights another interesting facet of the coal fleet}}
%     \label{fig:3}
% \end{figure}

% \begin{figure}
%     \includesvg[inkscapelatex=false,width=1\columnwidth]{svg_figs/correlation_matrix.svg}
%     \label{fig:s1}
%     \caption{\textbf{Variable Correlation Matrix} Note how the ret\_STATUS variable has a distinct lack of correlation to other variables}
% \end{figure}


